

<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7" lang="en"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8" lang="en"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
    <meta charset="UTF-8">
    <title>Vue 2.xæ•°æ®é©±åŠ¨æºç åˆ†æ</title>

    <meta name="author" content="Lucas Liao">

    <link rel="shortcut icon" href="/images/favicon.png">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

    <link rel="canonical" href="http://example.com/2020/01/11/2020-01-11/">

    
        <link rel="alternate" href="/atom.xml" type="application/atom+xml">
    

    

    
<script src="/js/modernizr-2.0.js"></script>


    
<script src="/js/jquery-1.9.1.js"></script>


    
    <script>window.twttr = (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0],
                t = window.twttr || {};
            if (d.getElementById(id)) return t;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js, fjs);

            t._e = [];
            t.ready = function(f) {
                t._e.push(f);
            };

            return t;
        }(document, "script", "twitter-wjs"));</script>

    
    <link rel="me" href="https://twitter.com/your_twitter">
    



    
<script src="/js/octo.js"></script>


    
<link rel="stylesheet" href="/css/octo.css">


    <link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet"
          type="text/css">

    <link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet"
          type="text/css">

    

<meta name="generator" content="Hexo 6.3.0"></head>
<body>

<header role="banner">
    <hgroup>
        <h1><a href="/">Lucas Liao&#39;s Blog</a></h1>
        
    </hgroup>
</header>

<nav role="navigation">
    
        <ul class="subscription" data-subscription="rss">
            <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
        </ul>
    

    <form action="https://google.com/search" method="get">
        <fieldset role="search">
            <input type="hidden" name="q" value="site:http://example.com/">
            <input class="search" type="text" name="q" results="0" placeholder="Search">
        </fieldset>
    </form>

    <ul class="main-navigation">
        
            <li><a href="/">Blog</a></li>
        
            <li><a href="/archives">Archives</a></li>
        
    </ul>
</nav>


<div id="main">
    <div id="content">
        <div>
    <article class="hentry" role="article">
        <header>
            <h1 class="entry-title">Vue 2.xæ•°æ®é©±åŠ¨æºç åˆ†æ</h1>
            <p class="meta">
                <time datetime="2020-01-10T16:00:00.000Z" data-updated="true">Sat Jan 11 2020</time>
            </p>
        </header>
        <div class="entry-content">
            <h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æœ€è¿‘çœ‹æºç çœ‹å¾—æœ‰ç‚¹ä¸Šå¤´ï¼Œè¶ç€å‘¨æœ«æœ‰ç©ºå°±è®°å½•ä¸‹ã€‚ä¹‹å‰å’ŒåŒäº‹è°ˆè®ºè¿‡ï¼Œä»–ä»¬å¯¹æºç éƒ½ä¸ä»¥ä¸ºæ„ï¼Œåœç•™åœ¨ä¸€ç§æ¡†æ¶åœç•™åœ¨èƒ½ç”¨å°±è¡Œäº†ï¼Œçœ‹çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œèƒ½è§£å†³è¦†ç›–80%ï¼Œç”šè‡³æ›´å¤šçš„ä¸šåŠ¡åœºæ™¯äº†ã€‚å¯¹äºæˆ‘æ¥è¯´ï¼Œä½¿ç”¨vueå·²ç»å¾ˆé•¿ä¸€æ®µæ—¶é—´äº†ï¼Œå¦‚ä½•å¯¹å†…éƒ¨å®ç°è¿˜æ˜¯ä¸æ¸…æ¥šçš„è¯ï¼Œæˆ‘è‡ªå·±æœ¬èº«ä¹Ÿè¯´ä¸è¿‡å»çš„ï¼Œå…³é”®æ˜¯æœ‰æ—¶å€™é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œåªæœ‰ç†è§£å†…éƒ¨æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Œæ‰èƒ½å¾ˆå¥½åœ°æ‰¾åˆ°åˆç†çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸æ˜¯è€æ˜¯é»‘äººé—®å·â€œä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿâ€</p>
<h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œvueå†…éƒ¨éå†dataå¯¹è±¡ï¼Œå¯¹æ•°æ®è¿›è¡Œæ¯ä¸ªåŠ«æŒï¼Œé‡æ–°å®šä¹‰äº†get, setæ–¹æ³•ã€‚setæ–¹æ³•å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æ”¹å˜å€¼æ—¶å€™è§¦å‘ï¼Œé‚£getæ–¹æ³•æ˜¯ä»€ä¹ˆæ—¶å€™è§¦å‘çš„å‘¢ï¼Ÿ</p>
<p>å¼•ç”¨å®˜æ–¹æ–‡æ¡£çš„æ¦‚è¿°ï¼Œå¦‚ä¸‹ï¼š</p>
<blockquote>
<p>å½“ä½ æŠŠä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ä¼ å…¥ Vue å®ä¾‹ä½œä¸º data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.defineProperty æŠŠè¿™äº›å±æ€§å…¨éƒ¨è½¬ä¸º getter&#x2F;setterã€‚Object.defineProperty æ˜¯ ES5 ä¸­ä¸€ä¸ªæ— æ³• shim çš„ç‰¹æ€§ï¼Œè¿™ä¹Ÿå°±æ˜¯ Vue ä¸æ”¯æŒ IE8 ä»¥åŠæ›´ä½ç‰ˆæœ¬æµè§ˆå™¨çš„åŸå› ã€‚<br>è¿™äº› getter&#x2F;setter å¯¹ç”¨æˆ·æ¥è¯´æ˜¯ä¸å¯è§çš„ï¼Œä½†æ˜¯åœ¨å†…éƒ¨å®ƒä»¬è®© Vue èƒ½å¤Ÿè¿½è¸ªä¾èµ–ï¼Œåœ¨å±æ€§è¢«è®¿é—®å’Œä¿®æ”¹æ—¶é€šçŸ¥å˜æ›´ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸åŒæµè§ˆå™¨åœ¨æ§åˆ¶å°æ‰“å°æ•°æ®å¯¹è±¡æ—¶å¯¹ getter&#x2F;setter çš„æ ¼å¼åŒ–å¹¶ä¸åŒï¼Œæ‰€ä»¥å»ºè®®å®‰è£… vue-devtools æ¥è·å–å¯¹æ£€æŸ¥æ•°æ®æ›´åŠ å‹å¥½çš„ç”¨æˆ·ç•Œé¢ã€‚<br>æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½å¯¹åº”ä¸€ä¸ª watcher å®ä¾‹ï¼Œå®ƒä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­æŠŠâ€œæ¥è§¦â€è¿‡çš„æ•°æ®å±æ€§è®°å½•ä¸ºä¾èµ–ã€‚ä¹‹åå½“ä¾èµ–é¡¹çš„ setter è§¦å‘æ—¶ï¼Œä¼šé€šçŸ¥ watcherï¼Œä»è€Œä½¿å®ƒå…³è”çš„ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p>
</blockquote>
<h3 id="mouted"><a href="#mouted" class="headerlink" title="mouted"></a>mouted</h3><p>ç®€å•åˆ†æä¸€æ³¢æºç ï½ï½é‚£å°±ä»å…¥å£è¯´èµ·å§ã€‚</p>
<p>ç°åœ¨vue2.xç‰ˆæœ¬ä¸€èˆ¬æ˜¯é€šè¿‡å®˜æ–¹è„šæ‰‹æ¶è¿›è¡Œæ­å»ºï¼Œåœ¨<code>src/main.js</code>ç›®å½•ä¸‹ï¼Œä¼šçœ‹åˆ°è¿™æ ·çš„ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">router</span>: router,</span><br><span class="line">    store,</span><br><span class="line">    i18n,</span><br><span class="line">    <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$mount</span> = <span class="keyword">function</span> (<span class="params"></span></span><br><span class="line"><span class="params">  el?: string | Element,</span></span><br><span class="line"><span class="params">  hydrating?: boolean</span></span><br><span class="line"><span class="params"></span>): <span class="title class_">Component</span> &#123;</span><br><span class="line">  el = el &amp;&amp; inBrowser ? <span class="title function_">query</span>(el) : <span class="literal">undefined</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">mountComponent</span>(<span class="variable language_">this</span>, el, hydrating)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è‡³äºä¼ å…¥çš„å‚æ•°æ˜¯æ€æ ·å¤„ç†çš„ï¼Œæˆ‘ä»¬æš‚æ—¶æ”¾åˆ°ä¸€è¾¹ï¼Œä¸€ç›®äº†ç„¶ï¼Œnewäº†ä¸€ä¸ªvueå®ä¾‹ï¼Œå¹¶ä¸”è°ƒç”¨äº†<code>$mount</code>æ–¹æ³•ã€‚</p>
<p>new Vue()çš„æ—¶å€™ï¼Œè°ƒç”¨<code>this._init</code>æ–¹æ³•ï¼Œå…¶ä¸­è¿™é‡Œå¯¹dataå¯¹è±¡ä¸­æ‰€æœ‰å±æ€§åˆ©ç”¨Object.defineProperty, è¿›è¡Œgeter&#x2F;seterå¤„ç†ã€‚</p>
<p>vueå¯¹<code>web/weex</code>ä¸åŒå¹³å°è¿è¡Œç¯å¢ƒè¿›è¡Œäº†å·®å¼‚åŒ–å¤„ç†ï¼Œä»¥webå¹³å°åˆ†æï¼Œæˆ‘ä»¬çœ‹åˆ°<code>$mount</code>çš„èµ‹å€¼å¦‚ä¸‹ï¼Œæ‰€æœ‰åœ¨å…¥å£å…¶å®æ˜¯è°ƒç”¨äº†<code>mountComponent()</code>æ–¹æ³•ï¼Œæˆ‘ä»¬ç»§ç»­æ·±å…¥æ¢ç©¶<code>mountComponent()</code>å†…éƒ¨æ˜¯æ€æ ·å®ç°çš„ã€‚</p>
<p>è¿›å…¥mountComponentï¼Œå°†ç»„ä»¶çš„elementå…ƒç´ èµ‹å€¼ç»™$elï¼Œè§¦å‘äº†beforeMountç”Ÿå‘½å‘¨æœŸï¼Œåˆ›å»ºäº†ä¸€ä¸ª<code>Watch</code>å®ä¾‹ï¼Œæœ€åè§¦å‘äº†mountedç”Ÿå‘½å‘¨æœŸï¼Œè¿”å›vm componentå¯¹è±¡ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">mountComponent</span> (</span><br><span class="line">  <span class="attr">vm</span>: <span class="title class_">Component</span>,</span><br><span class="line">  <span class="attr">el</span>: ?<span class="title class_">Element</span>,</span><br><span class="line">  hydrating?: boolean</span><br><span class="line">): <span class="title class_">Component</span> &#123;</span><br><span class="line">    vm.<span class="property">$el</span> = el</span><br><span class="line">    <span class="keyword">if</span> (!vm.<span class="property">$options</span>.<span class="property">render</span>) &#123;</span><br><span class="line">        vm.<span class="property">$options</span>.<span class="property">render</span> = createEmptyVNode</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">callHook</span>(vm, <span class="string">&#x27;beforeMount&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> updateComponent</span><br><span class="line">    updateComponent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        vm.<span class="title function_">_update</span>(vm.<span class="title function_">_render</span>(), hydrating)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Watcher</span>(vm, updateComponent, noop, &#123;</span><br><span class="line">        before () &#123;</span><br><span class="line">        <span class="keyword">if</span> (vm.<span class="property">_isMounted</span> &amp;&amp; !vm.<span class="property">_isDestroyed</span>) &#123;</span><br><span class="line">            <span class="title function_">callHook</span>(vm, <span class="string">&#x27;beforeUpdate&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="literal">true</span> <span class="comment">/* isRenderWatcher */</span>)</span><br><span class="line">    hydrating = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (vm.<span class="property">$vnode</span> == <span class="literal">null</span>) &#123;</span><br><span class="line">        vm.<span class="property">_isMounted</span> = <span class="literal">true</span></span><br><span class="line">        <span class="title function_">callHook</span>(vm, <span class="string">&#x27;mounted&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> vm</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="watcher"><a href="#watcher" class="headerlink" title="watcher"></a>watcher</h3><p>æˆ‘ä»¬æŠŠç„¦ç‚¹æ”¾åˆ°<code>new Watcher</code>ï¼Œè¿™æ®µä»£ç å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿè½¬åˆ°<code>Watcher</code>ç±»çš„å®šä¹‰ï¼Œé¦–å…ˆåœ¨constructorå°†<code>watcher</code>çš„å®ä¾‹çš„<code>this</code>ï¼Œpushåˆ°<code>vm._watchers</code>æ•°ç»„é‡Œé¢ï¼Œç„¶åå¯¹ä¸€åºåˆ—çš„å‚æ•°è¿›è¡Œèµ‹å€¼åˆå§‹åŒ–ï¼Œæœ€åè°ƒç”¨äº†é‡Œé¢çš„<code>this.get()</code>æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Watcher</span> &#123;</span><br><span class="line">  <span class="attr">vm</span>: <span class="title class_">Component</span>;</span><br><span class="line">  <span class="attr">cb</span>: <span class="title class_">Function</span>;</span><br><span class="line">  <span class="attr">id</span>: number;</span><br><span class="line">  <span class="attr">deep</span>: boolean;</span><br><span class="line">  <span class="attr">user</span>: boolean;</span><br><span class="line">  <span class="attr">lazy</span>: boolean;</span><br><span class="line">  <span class="attr">sync</span>: boolean;</span><br><span class="line">  <span class="attr">dirty</span>: boolean;</span><br><span class="line">  <span class="attr">active</span>: boolean;</span><br><span class="line">  <span class="attr">deps</span>: <span class="title class_">Array</span>&lt;<span class="title class_">Dep</span>&gt;;</span><br><span class="line">  <span class="attr">newDeps</span>: <span class="title class_">Array</span>&lt;<span class="title class_">Dep</span>&gt;;</span><br><span class="line">  <span class="attr">depIds</span>: <span class="title class_">SimpleSet</span>;</span><br><span class="line">  <span class="attr">newDepIds</span>: <span class="title class_">SimpleSet</span>;</span><br><span class="line">  <span class="attr">before</span>: ?<span class="title class_">Function</span>;</span><br><span class="line">  <span class="attr">getter</span>: <span class="title class_">Function</span>;</span><br><span class="line">  <span class="attr">value</span>: any;</span><br><span class="line">  <span class="title function_">constructor</span> (</span><br><span class="line">    <span class="attr">vm</span>: <span class="title class_">Component</span>,</span><br><span class="line">    <span class="attr">expOrFn</span>: string | <span class="title class_">Function</span>,</span><br><span class="line">    <span class="attr">cb</span>: <span class="title class_">Function</span>,</span><br><span class="line">    options?: ?<span class="title class_">Object</span>,</span><br><span class="line">    isRenderWatcher?: boolean</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vm</span> = vm</span><br><span class="line">    vm.<span class="property">_watchers</span>.<span class="title function_">push</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="comment">// options</span></span><br><span class="line">    <span class="keyword">if</span> (options) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">deep</span> = !!options.<span class="property">deep</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">user</span> = !!options.<span class="property">user</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">lazy</span> = !!options.<span class="property">lazy</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">sync</span> = !!options.<span class="property">sync</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">before</span> = options.<span class="property">before</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">deep</span> = <span class="variable language_">this</span>.<span class="property">user</span> = <span class="variable language_">this</span>.<span class="property">lazy</span> = <span class="variable language_">this</span>.<span class="property">sync</span> = <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">cb</span> = cb</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = ++uid <span class="comment">// uid for batching</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">active</span> = <span class="literal">true</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dirty</span> = <span class="variable language_">this</span>.<span class="property">lazy</span> <span class="comment">// for lazy watchers</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">deps</span> = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">newDeps</span> = []</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">depIds</span> = <span class="keyword">new</span> <span class="title class_">Set</span>()</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">newDepIds</span> = <span class="keyword">new</span> <span class="title class_">Set</span>()</span><br><span class="line">      ? expOrFn.<span class="title function_">toString</span>()</span><br><span class="line">      : <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment">// parse expression for getter</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> expOrFn === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">getter</span> = expOrFn</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">getter</span> = <span class="title function_">parsePath</span>(expOrFn)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = <span class="variable language_">this</span>.<span class="property">lazy</span></span><br><span class="line">      ? <span class="literal">undefined</span></span><br><span class="line">      : <span class="variable language_">this</span>.<span class="title function_">get</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ä¾èµ–æ”¶é›†"><a href="#ä¾èµ–æ”¶é›†" class="headerlink" title="ä¾èµ–æ”¶é›†"></a>ä¾èµ–æ”¶é›†</h3><p>åœ¨get()å¤„ç†å¦‚ä¸‹é€»è¾‘ï¼Œå…ˆå–µä¸€ä¸‹ä¸»æµç¨‹ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">get () &#123;</span><br><span class="line">    <span class="title function_">pushTarget</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="keyword">let</span> value</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="variable language_">this</span>.<span class="property">vm</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      value = <span class="variable language_">this</span>.<span class="property">getter</span>.<span class="title function_">call</span>(vm, vm)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">user</span>) &#123;</span><br><span class="line">        <span class="title function_">handleError</span>(e, vm, <span class="string">`getter for watcher &quot;<span class="subst">$&#123;<span class="variable language_">this</span>.expression&#125;</span>&quot;`</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> e</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="comment">// &quot;touch&quot; every property so they are all tracked as</span></span><br><span class="line">      <span class="comment">// dependencies for deep watching</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">deep</span>) &#123;</span><br><span class="line">        <span class="title function_">traverse</span>(value)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">popTarget</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">cleanupDeps</span>()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The current target watcher being evaluated.</span></span><br><span class="line"><span class="comment">// This is globally unique because only one watcher</span></span><br><span class="line"><span class="comment">// can be evaluated at a time.</span></span><br><span class="line"><span class="title class_">Dep</span>.<span class="property">target</span> = <span class="literal">null</span></span><br><span class="line"><span class="keyword">const</span> targetStack = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">pushTarget</span> (<span class="attr">target</span>: ?<span class="title class_">Watcher</span>) &#123;</span><br><span class="line">  targetStack.<span class="title function_">push</span>(target)</span><br><span class="line">  <span class="title class_">Dep</span>.<span class="property">target</span> = target</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">popTarget</span> () &#123;</span><br><span class="line">  targetStack.<span class="title function_">pop</span>()</span><br><span class="line">  <span class="title class_">Dep</span>.<span class="property">target</span> = targetStack[targetStack.<span class="property">length</span> - <span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="pushTarget-this"><a href="#pushTarget-this" class="headerlink" title="pushTarget(this)"></a>pushTarget(this)</h4><p>å°†å½“å‰watcheræ”¾åˆ°targetStacké˜Ÿåˆ—, åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªwatcherå¤„äºæ”¶é›†çŠ¶æ€</p>
<h4 id="this-getter-call-vm-vmï¼‰"><a href="#this-getter-call-vm-vmï¼‰" class="headerlink" title="this.getter.call(vm, vmï¼‰"></a>this.getter.call(vm, vmï¼‰</h4><p>å›é¡¾<code>mountComponent()</code>æ–¹æ³•çš„ä¼ å‚ï¼Œå…¶å®<code>watcher</code>çš„<code>getter</code>æ–¹æ³•å°±æ˜¯è°ƒç”¨ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> updateComponent</span><br><span class="line">updateComponent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    vm.<span class="title function_">_update</span>(vm.<span class="title function_">_render</span>(), hydrating)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è€Œ<code>_update</code>çš„æ ¸å¿ƒæ˜¯è§¦å‘<code>__patch__</code>ï¼Œæ ¹æ®è™šæ‹Ÿvnodeï¼Œç”ŸæˆçœŸå®çš„Domå…ƒç´ , ä¸‹é¢æ˜¯<code>_update</code>çš„å®šä¹‰:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">_update</span> = <span class="keyword">function</span> (<span class="params">vnode: VNode, hydrating?: boolean</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="attr">vm</span>: <span class="title class_">Component</span> = <span class="variable language_">this</span></span><br><span class="line">    <span class="keyword">const</span> prevEl = vm.<span class="property">$el</span></span><br><span class="line">    <span class="keyword">const</span> prevVnode = vm.<span class="property">_vnode</span></span><br><span class="line">    <span class="keyword">const</span> restoreActiveInstance = <span class="title function_">setActiveInstance</span>(vm)</span><br><span class="line">    vm.<span class="property">_vnode</span> = vnode</span><br><span class="line">    <span class="comment">// Vue.prototype.__patch__ is injected in entry points</span></span><br><span class="line">    <span class="comment">// based on the rendering backend used.</span></span><br><span class="line">    <span class="keyword">if</span> (!prevVnode) &#123;</span><br><span class="line">      <span class="comment">// initial render</span></span><br><span class="line">      vm.<span class="property">$el</span> = vm.<span class="title function_">__patch__</span>(vm.<span class="property">$el</span>, vnode, hydrating, <span class="literal">false</span> <span class="comment">/* removeOnly */</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// updates</span></span><br><span class="line">      vm.<span class="property">$el</span> = vm.<span class="title function_">__patch__</span>(prevVnode, vnode)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">restoreActiveInstance</span>()</span><br><span class="line">    <span class="comment">// update __vue__ reference</span></span><br><span class="line">    <span class="keyword">if</span> (prevEl) &#123;</span><br><span class="line">      prevEl.<span class="property">__vue__</span> = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (vm.<span class="property">$el</span>) &#123;</span><br><span class="line">      vm.<span class="property">$el</span>.<span class="property">__vue__</span> = vm</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// if parent is an HOC, update its $el as well</span></span><br><span class="line">    <span class="keyword">if</span> (vm.<span class="property">$vnode</span> &amp;&amp; vm.<span class="property">$parent</span> &amp;&amp; vm.<span class="property">$vnode</span> === vm.<span class="property">$parent</span>.<span class="property">_vnode</span>) &#123;</span><br><span class="line">      vm.<span class="property">$parent</span>.<span class="property">$el</span> = vm.<span class="property">$el</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// updated hook is called by the scheduler to ensure that children are</span></span><br><span class="line">    <span class="comment">// updated in a parent&#x27;s updated hook.</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="å¦‚ä½•è¿›è¡Œä¾èµ–æ”¶é›†å‘¢"><a href="#å¦‚ä½•è¿›è¡Œä¾èµ–æ”¶é›†å‘¢" class="headerlink" title="å¦‚ä½•è¿›è¡Œä¾èµ–æ”¶é›†å‘¢"></a>å¦‚ä½•è¿›è¡Œä¾èµ–æ”¶é›†å‘¢</h4><p>å›åˆ°get&#x2F;seterçš„å¤„ç†ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, key, &#123;</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">reactiveGetter</span> () &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.<span class="title function_">call</span>(obj) : val</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Dep</span>.<span class="property">target</span>) &#123;</span><br><span class="line">        dep.<span class="title function_">depend</span>()</span><br><span class="line">        <span class="keyword">if</span> (childOb) &#123;</span><br><span class="line">          childOb.<span class="property">dep</span>.<span class="title function_">depend</span>()</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)) &#123;</span><br><span class="line">            <span class="title function_">dependArray</span>(value)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> value</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">set</span>: <span class="keyword">function</span> <span class="title function_">reactiveSetter</span> (newVal) &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.<span class="title function_">call</span>(obj) : val</span><br><span class="line">      <span class="comment">/* eslint-disable no-self-compare */</span></span><br><span class="line">      <span class="keyword">if</span> (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* eslint-enable no-self-compare */</span></span><br><span class="line">      <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; customSetter) &#123;</span><br><span class="line">        <span class="title function_">customSetter</span>()</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// #7981: for accessor properties without setter</span></span><br><span class="line">      <span class="keyword">if</span> (getter &amp;&amp; !setter) <span class="keyword">return</span></span><br><span class="line">      <span class="keyword">if</span> (setter) &#123;</span><br><span class="line">        setter.<span class="title function_">call</span>(obj, newVal)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        val = newVal</span><br><span class="line">      &#125;</span><br><span class="line">      childOb = !shallow &amp;&amp; <span class="title function_">observe</span>(newVal)</span><br><span class="line">      dep.<span class="title function_">notify</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°åœ¨geté‡Œé¢ï¼Œè§¦å‘äº†<code>dep.depend()</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">depend () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="title class_">Dep</span>.<span class="property">target</span>) &#123;</span><br><span class="line">      <span class="title class_">Dep</span>.<span class="property">target</span>.<span class="title function_">addDep</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢è¯´åˆ°ï¼Œåœ¨å®ä¾‹åŒ–watcherçš„æ—¶å€™ï¼ŒpushTarget(this)ï¼Œå³ target &#x3D;&gt; watcher, å› æ­¤åœ¨getçš„æ—¶å€™ï¼Œå°±æ˜¯è§¦å‘äº†watcheré‡Œé¢çš„<code>addDep</code>, åŒä¸€ä¸ªwatcheré€šè¿‡newDepIdsç»´æŠ¤ï¼Œæ ¹æ®idé¿å…<br>æ”¶é›†é‡å¤çš„ä¾èµ–ï½ï½</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">addDep (<span class="attr">dep</span>: <span class="title class_">Dep</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> id = dep.<span class="property">id</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">newDepIds</span>.<span class="title function_">has</span>(id)) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">newDepIds</span>.<span class="title function_">add</span>(id)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">newDeps</span>.<span class="title function_">push</span>(dep)</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">depIds</span>.<span class="title function_">has</span>(id)) &#123;</span><br><span class="line">        dep.<span class="title function_">addSub</span>(<span class="variable language_">this</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨vnodeè½¬åŒ–æˆçœŸå®Domå…ƒç´ çš„æ—¶å€™ï¼Œä¼šè§¦å‘æ•°æ®ç»‘å®šä¸­çš„get, è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œæ”¶é›†å®Œæˆè°ƒç”¨popTarget()ï¼Œthis.cleanupDeps(), é¿å…é€ æˆå¯¹ä¸‹ä¸€æ¬¡ä¾èµ–æ”¶é›†çš„æ±¡æŸ“ã€‚</p>
<p>æ‰€æœ‰ä¾èµ–å¡è¿›ä¸€ä¸ªæ•°ç»„é˜Ÿåˆ—<code>subs</code>ç»´æŠ¤ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œåœ¨setæ–¹æ³•è§¦å‘<code>notify()</code>, éå†subsé‡Œé¢çš„å…ƒç´ ï¼ˆå…¶å®å°±æ˜¯watcherå¯¹è±¡ï¼‰ï¼Œè°ƒç”¨<code>watcher</code>å¯¹è±¡çš„<code>update()</code>æ–¹æ³•, è§¦<code>run()</code>æ–¹æ³•è¿›è¡Œæ´¾å‘æ›´æ–°ï¼Œæœ€ç»ˆè¿˜æ˜¯å›åˆ°äº†<code>vm._update(vm._render(), hydrating)</code>ï¼Œæ›´æ–°æ¸²æŸ“ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ å†…éƒ¨æ ¹æ®ç»„ä»¶idè¿›è¡Œæ’åºï¼Œä¿è¯æ›´æ–°é¡ºåºæ˜¯ç”±çˆ¶ç»„ä»¶åˆ°å­ç»„ä»¶ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">queue.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="property">id</span> - b.<span class="property">id</span>)</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†æé«˜æ€§èƒ½vueå®è¡Œå¼‚æ­¥æ›´æ–°watcheré˜Ÿåˆ—, å°±æ˜¯å°†<code>watcher.run()</code>æ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¦‚ï¼š</p>
<ul>
<li><code>Promise.resolve(flushCallbacks)</code></li>
<li><code>setTimeout(flushCallbacks, 0)</code></li>
<li><code>const observer = new MutationObserver(flushCallbacks)</code></li>
</ul>
<p>è´´å‡ºå®˜æ–¹æ–‡æ¡£çš„è§£é‡Šï¼š</p>
<blockquote>
<p>å¯èƒ½ä½ è¿˜æ²¡æœ‰æ³¨æ„åˆ°ï¼ŒVue åœ¨æ›´æ–° DOM æ—¶æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚åªè¦ä¾¦å¬åˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°†å¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ç¼“å†²åœ¨åŒä¸€äº‹ä»¶å¾ªç¯ä¸­å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®å˜æ›´ã€‚å¦‚æœåŒä¸€ä¸ª watcher è¢«å¤šæ¬¡è§¦å‘ï¼Œåªä¼šè¢«æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ä¸€æ¬¡ã€‚è¿™ç§åœ¨ç¼“å†²æ—¶å»é™¤é‡å¤æ•°æ®å¯¹äºé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œ DOM æ“ä½œæ˜¯éå¸¸é‡è¦çš„ã€‚ç„¶åï¼Œåœ¨ä¸‹ä¸€ä¸ªçš„äº‹ä»¶å¾ªç¯â€œtickâ€ä¸­ï¼ŒVue åˆ·æ–°é˜Ÿåˆ—å¹¶æ‰§è¡Œå®é™… (å·²å»é‡çš„) å·¥ä½œã€‚Vue åœ¨å†…éƒ¨å¯¹å¼‚æ­¥é˜Ÿåˆ—å°è¯•ä½¿ç”¨åŸç”Ÿçš„ Promise.thenã€MutationObserver å’Œ setImmediateï¼Œå¦‚æœæ‰§è¡Œç¯å¢ƒä¸æ”¯æŒï¼Œåˆ™ä¼šé‡‡ç”¨ setTimeout(fn, 0) ä»£æ›¿ã€‚<br>ä¾‹å¦‚ï¼Œå½“ä½ è®¾ç½® vm.someData &#x3D; â€˜new valueâ€™ï¼Œè¯¥ç»„ä»¶ä¸ä¼šç«‹å³é‡æ–°æ¸²æŸ“ã€‚å½“åˆ·æ–°é˜Ÿåˆ—æ—¶ï¼Œç»„ä»¶ä¼šåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯â€œtickâ€ä¸­æ›´æ–°ã€‚å¤šæ•°æƒ…å†µæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒè¿™ä¸ªè¿‡ç¨‹ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³åŸºäºæ›´æ–°åçš„ DOM çŠ¶æ€æ¥åšç‚¹ä»€ä¹ˆï¼Œè¿™å°±å¯èƒ½ä¼šæœ‰äº›æ£˜æ‰‹ã€‚è™½ç„¶ Vue.js é€šå¸¸é¼“åŠ±å¼€å‘äººå‘˜ä½¿ç”¨â€œæ•°æ®é©±åŠ¨â€çš„æ–¹å¼æ€è€ƒï¼Œé¿å…ç›´æ¥æ¥è§¦ DOMï¼Œä½†æ˜¯æœ‰æ—¶æˆ‘ä»¬å¿…é¡»è¦è¿™ä¹ˆåšã€‚ä¸ºäº†åœ¨æ•°æ®å˜åŒ–ä¹‹åç­‰å¾… Vue å®Œæˆæ›´æ–° DOMï¼Œå¯ä»¥åœ¨æ•°æ®å˜åŒ–ä¹‹åç«‹å³ä½¿ç”¨ Vue.nextTick(callback)ã€‚è¿™æ ·å›è°ƒå‡½æ•°å°†åœ¨ DOM æ›´æ–°å®Œæˆåè¢«è°ƒç”¨</p>
</blockquote>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¯¹vue 2.xçš„æºç åˆ†æè‡³æ­¤over, åœ¨debugçš„è¿‡ç¨‹ä¸­ï¼Œæ›¾ç»æ€€ç–‘è¿‡æ˜¯å¦å€¼å¾—èŠ±è¿™ä¹ˆå¤šæ—¶é—´å»åšè¿™ä¸ªäº‹æƒ…ï¼Œä½†æœ€ç»ˆè¿˜æ˜¯èµ°è¿‡æ¥äº†ï¼Œæ·±å…¥debugæºç æˆ‘è§‰å¾—æœ‰ä¸¤ç‚¹æ˜¯éå¸¸é‡è¦çš„ï¼š</p>
<ul>
<li>äº†è§£æ¡†æ¶å†…éƒ¨å®ç°</li>
<li>å­¦ä¹ ç¼–ç¨‹è®¾è®¡æ¨¡å¼</li>
</ul>
<p>æˆ‘å¯¹è‡ªå·±å¯¹è¦æ±‚æ˜¯ï¼Œæ˜¯å¦åƒé€äº†JavaScriptï¼Œæ˜¯å¦è¾¾åˆ°ä¸ºæ‰€æ¬²ä¸ºçš„ç¨‹åº¦ï¼Ÿå¾ˆæ˜¾ç„¶ï¼Œç¦»è¿™ä¸ªæ°´å¹³è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼Œé‚£å°±ç»§ç»­åŠªåŠ›å§ã€‚æ¥ä¸‹æ¥è½¬æˆ˜vue 3.0äº†ï¼Œæˆ‘å¯èƒ½ä¼šå†å»æ’¸ä¸€évue 3.0çš„æºç ï¼Œå¤§æ¦‚å°±æ˜¯æƒ³å­¦å¥½<code>typescript</code>ğŸ˜¬</p>

        </div>
        <footer>
            <p class="meta">
                <span class="byline author vcard">Posted by <span class="fn">Lucas Liao</span></span>
                <time datetime="2020-01-10T16:00:00.000Z" data-updated="true">Sat Jan 11 2020</time>
                
    <span class="categories">
    
        <a class="category" href="/tags/vue/">vue</a>
    
    </span>

            </p>
            <div class="sharing">
    
        <a class="twitter-share-button"
           target="_blank" rel="noopener" href="https://twitter.com/intent/tweet?text=Vue%202.x%E6%95%B0%E6%8D%AE%E9%A9%B1%E5%8A%A8%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90">
            Tweet
        </a>
    
</div>

            <p class="meta">
                
                <a class="basic-alignment left" href="/" title="Previous Post: Vue 3.0æºç åˆçª¥">Â« Vue 3.0æºç åˆçª¥</a>
                

                
                <a class="basic-alignment right" href="/" title="Previous Post: æœ€è¿‘çš„ä¸€äº›æ„Ÿæ‚Ÿ">æœ€è¿‘çš„ä¸€äº›æ„Ÿæ‚Ÿ Â»</a>
                
            </p>
        </footer>
    </article>

    

</div>

<aside class="sidebar">
    <section class="odd">
    <h1>Recent Posts</h1>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/08/04/2023-08-04/">å¦‚ä½•ç†è§£ä¾èµ–æ³¨å…¥ï¼Ÿ</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/07/25/2023-07-25/">è¶Šè¿‡äº†5å¹´ç»éªŒçš„é—¨æ§›</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/11/2021-05-11/">å½“å›¢é˜Ÿä¸­åªæœ‰ä¸€ä¸ªå‰ç«¯</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/20/2020-09-20/">é€šè¿‡snabbdomåŸç”Ÿå®ç°ç®€æ˜“çš„è®°è´¦æœ¬</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/23/2020-07-23/">äºŒå‰æ ‘éé€’å½’éå†å­¦ä¹ ç¬”è®°</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/23/2020-8-13/">ä¸€äº›æœ‰è¶£çš„jsç¼–ç¨‹æŠ€å·§</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/06/2020-06-06/">Lifebyteå·¥ä½œæ€»ç»“</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/20/2020-04-20/">typescript error handle</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/12/2020-04-12/">graphql</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/01/2020-04-01/">å››æœˆä»½flag</a></li></ul>
</section><section class="even">
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
        <li class="loading">Status updating&#8230;</li>
    </ul>

    <a target="_blank" rel="noopener" href="https://github.com/yiyu-liao">@yiyu-liao</a> on GitHub

    <script>
        $(document).ready(function(){
            const options = {
                user: 'yiyu-liao',
                count: 0,
                skip_forks: true,
                target: '#gh_repos'
            }

            function escapeHtml(str) {
                return $('<div/>').text(str).html();
            }

            function render(target, repos){
                let i, fragment = '', t = $(target)[0];

                for(i = 0; i < repos.length; i++) {
                    fragment += '<li><a href="'+repos[i].html_url+'">'+repos[i].name+'</a><p>'+escapeHtml(repos[i].description||'')+'</p></li>';
                }
                t.innerHTML = fragment;
            }

            $.ajax({
                url: "https://api.github.com/users/"+options.user+"/repos?sort=pushed&callback=?",
                dataType: 'jsonp',
                error: function (err) {
                    $(options.target + ' li.loading').addClass('error').text("Error loading feed");
                },
                success: function(data) {
                    var repos = [];
                    if (!data || !data.data) { return; }
                    for (var i = 0; i < data.data.length; i++) {
                        if (options.skip_forks && data.data[i].fork) { continue; }
                        repos.push(data.data[i]);
                    }
                    if (options.count) { repos.splice(options.count); }
                    render(options.target, repos);
                }
            });
        });
    </script>
</section>
</aside>

    </div>
</div>

<footer role="contentinfo">
    <p>
        Copyright Â© 2023 - Lucas Liao -
        <span class="credit">Generated using <a target="_blank" rel="noopener" href="https://github.com/jbreckmckye/hexo-theme-octo">Octo theme</a> for <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></span>
    </p>
</footer>



</body>
</html>
